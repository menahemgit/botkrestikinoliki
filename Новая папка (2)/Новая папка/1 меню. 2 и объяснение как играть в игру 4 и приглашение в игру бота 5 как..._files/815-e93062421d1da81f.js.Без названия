!function(){try{var e="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},t=Error().stack;t&&(e._sentryDebugIds=e._sentryDebugIds||{},e._sentryDebugIds[t]="4c5b89da-9e0b-47d2-8566-32d1bb578a3b",e._sentryDebugIdIdentifier="sentry-dbid-4c5b89da-9e0b-47d2-8566-32d1bb578a3b")}catch(e){}}();"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[815],{38270:function(e,t,n){n.d(t,{v:function(){return U}});var a=n(53854),r=n(20981),i=n(21129),s=n(64980),l=n(60359),o=n(77466),c=n(25462),d=n(81854),u=n(89e3),m=n(2998),p=n(69192),g=n(22571),h=n(92508),f=n(6503);let x=e=>{let{isOpen:t,onClose:n,onAddProduct:r,sectionTitle:i,section:s}=e,o=(0,l.useTranslations)("article.productSheet");return(0,a.jsx)(p.Z,{isOpen:t,variant:"side-sheet",onClose:n,title:o("title"),subtitle:i,children:(0,a.jsx)(b,{section:s,onAddProduct:r})})},b=e=>{let{section:t,onAddProduct:n}=e,[i,s]=(0,r.useState)(!1),[o,c]=(0,r.useState)(""),[d,p]=(0,r.useState)([]),h=(0,l.useTranslations)("article.productSheet"),{searchShoppingForQuery:f}=(0,u.Z)();return(0,a.jsxs)("div",{children:[(0,a.jsx)(m.M,{onSearchSubmit:()=>{t.backend_uuid&&(s(!0),f({query:o,sectionUUID:t.backend_uuid,onSuccessCallback:e=>{p(e),s(!1)}}))},searchValue:o,setSearchValue:c,onSearchClear:()=>{c(""),p([])},placeholder:h("searchPlaceholder"),isLoading:i}),(0,a.jsx)("div",{className:"grid auto-rows-min grid-cols-3 gap-md py-md",children:i?(0,a.jsx)(a.Fragment,{children:Array.from({length:3}).map((e,t)=>(0,a.jsxs)("div",{className:"flex flex-col gap-md",children:[(0,a.jsx)(g.ZP,{variant:"offset",className:"aspect-square animate-pulse rounded-md"}),(0,a.jsxs)("div",{className:"flex flex-col gap-sm",children:[(0,a.jsx)(g.ZP,{variant:"offset",className:"h-4 w-4/5 animate-pulse rounded-full"},t),(0,a.jsx)(g.ZP,{variant:"offset",className:"h-4 w-2/5 animate-pulse rounded-full"},t)]})]},"loading-article-product-".concat(t)))}):d.map(e=>(0,a.jsx)(j,{widgetSearchResult:e,onClick:()=>n(e)},e.url))})]})},j=e=>{let{widgetSearchResult:t,onClick:n}=e,r=d.BO.safeParse(t.meta_data);if(!r.success)return f.Tb("Invalid widget data",{extra:{widgetSearchResult:t}}),null;let i=r.data;return(0,a.jsx)(g.ZP,{className:"group relative cursor-pointer duration-150 active:scale-[0.99]",onClick:n,children:(0,a.jsxs)("div",{className:"relative flex flex-col items-center gap-sm",children:[i.image_url&&(0,a.jsx)(o.W,{className:"pointer-events-none w-full !rounded-md shadow-sm group-hover:opacity-70",src:i.image_url}),(0,a.jsxs)("div",{className:"flex w-full flex-col justify-start gap-xs",children:[i.name&&(0,a.jsx)(h.Z,{variant:"baseSemi",className:"leading-tight",children:i.name}),i.num_reviews&&i.rating&&(0,a.jsx)(c.D,{reviewCount:i.num_reviews,rating:i.rating}),(0,a.jsx)(h.Z,{variant:"small",children:i.price})]})]})})};var z=n(70154);let v=e=>{let{section:t,sectionTitle:n,onAddProduct:i}=e,[o,c]=(0,r.useState)(!1),d=(0,l.useTranslations)("article");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"flex items-center justify-center",children:(0,a.jsxs)(g.ZP,{className:"group relative w-full cursor-pointer py-md duration-150 active:scale-[0.99]",onClick:()=>{c(!0)},children:[(0,a.jsx)("div",{className:"pointer-events-none absolute -inset-x-sm inset-y-sm scale-[0.98] rounded-md bg-offset opacity-0 duration-150 group-hover:scale-100 group-hover:opacity-100 dark:bg-offsetDark"}),(0,a.jsxs)("div",{className:"relative flex items-center gap-md",children:[(0,a.jsx)(g.ZP,{variant:"offsetPlus",className:"pointer-events-none flex !size-[65px] items-center justify-center !rounded-md text-textOff shadow-sm dark:text-textOffDark",children:(0,a.jsx)(s.G,{icon:z.faPlus})}),(0,a.jsx)("div",{className:"flex flex-1 flex-col gap-xs",children:(0,a.jsx)(h.Z,{color:"light",variant:"smallBold",children:d("productSheet.title")})})]})]})}),(0,a.jsx)(x,{isOpen:o,section:t,sectionTitle:n,onClose:()=>{c(!1)},onAddProduct:e=>{c(!1),i(e)}})]})};var y=n(77301),w=n(109),_=n(14180),k=n(4009),N=n(48210),C=n(45138),S=n(2355),E=n(97852);let D=e=>{let{item:t,canEdit:n,idx:r,onDelete:i,variant:s="list"}=e,l=t.id,o=()=>{let e=document.querySelector("[data-widget-id='".concat(l,"']"));if(e){let t=e.getBoundingClientRect().top+window.scrollY-60;window.scrollTo({top:t,behavior:"smooth"})}};return"list"===s?(0,a.jsx)(Z,{canEdit:n,item:t,onClick:o,onDelete:null!=i?i:()=>{},idx:r}):(0,a.jsx)(W,{canEdit:n,item:t,onClick:o})},Z=e=>{let{onClick:t,onDelete:n,item:r,idx:i,canEdit:s}=e,{isMobileStyle:d}=(0,k.d)(),{image_url:u,num_reviews:m,rating:p}=r,f=(0,l.useTranslations)("shop");return(0,a.jsxs)(g.ZP,{className:"group relative cursor-pointer py-md duration-150 active:scale-[0.99]",onClick:t,children:[(0,a.jsx)("div",{className:"pointer-events-none absolute -inset-x-sm inset-y-sm scale-[0.98] rounded-md bg-offset opacity-0 duration-150 group-hover:scale-100 group-hover:opacity-100"}),(0,a.jsxs)("div",{className:"gap-m just relative flex w-full items-center gap-md duration-150 group-hover:opacity-70",children:[u&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("div",{className:"relative !size-[60px] shrink-0 overflow-hidden !rounded-md bg-white p-xs after:absolute after:inset-0 after:rounded-[inherit] after:border after:border-black/10 after:content-['']",children:(0,a.jsx)(o.W,{className:"!bg-white",src:u})}),(0,a.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-offset/50 opacity-0 duration-150 group-hover:opacity-100",children:(0,a.jsx)("div",{className:"aspect-square shrink-0 items-center justify-center gap-xs rounded-full bg-background shadow-md duration-150 md:aspect-auto md:w-auto md:px-[10px] md:py-xs",children:(0,a.jsx)(h.Z,{className:"flex items-center gap-sm whitespace-nowrap",variant:d?"small":"tiny",children:(0,a.jsx)("span",{className:"hidden md:inline-flex",children:f("view")})})})}),(0,a.jsx)(h.Z,{className:"absolute -left-xs -top-xs flex size-md items-center justify-center rounded-full bg-borderMain",variant:"smallCaps",color:"light",children:i+1})]}),(0,a.jsxs)("div",{className:"flex flex-1 flex-col gap-xs",children:[(0,a.jsx)(h.Z,{variant:"smallBold",className:"line-clamp-2 leading-tight",children:r.name}),(0,a.jsxs)(N.Root,{className:"gap-xs text-textOff",delimiter:"",children:[(0,a.jsx)(N.Item,{id:"price",children:(0,a.jsx)(h.Z,{variant:"tiny",color:"light",children:r.price})}),r.variants&&r.variants[0].compare_at_price&&(0,a.jsx)(N.Item,{id:"originalPrice",children:(0,a.jsx)(h.Z,{variant:"tiny",color:"light",className:"line-through opacity-70",children:r.variants[0].compare_at_price})}),p&&(0,a.jsx)(N.Item,{id:"rating",children:(0,a.jsx)(c.D,{reviewCount:m,rating:p,size:"2xs",textVariant:"tiny",className:"mb-[2px]",variant:"truncated"})})]})]}),s&&(0,a.jsx)(I,{onDelete:n})]})]})},I=e=>{let{onDelete:t}=e,n=(0,l.useTranslations)("article"),{isMobileStyle:i}=(0,k.d)(),[s,o]=(0,r.useState)(!1);return(0,a.jsx)(C.DropDownMenu,{items:[{text:n("section.remove"),icon:_.$,destructive:!0,onClick:e=>{t(),e.stopPropagation()}}],isMobileStyle:i,isOpen:s,onClose:()=>{o(!1)},children:(0,a.jsx)(S.Z,{icon:w.faEllipsis,extraCSS:"",size:"tiny",pill:!0,onClick:e=>{o(!0),e.stopPropagation()}})})},W=e=>{let{onClick:t,item:n}=e,{image_url:r,num_reviews:i,rating:s}=n;return(0,a.jsx)(g.ZP,{variant:"offset",bgHover:"offsetPlus",className:"group relative flex shrink-0 cursor-pointer rounded-lg px-sm py-sm duration-150 active:scale-[0.99]",onClick:t,children:(0,a.jsxs)("div",{className:"relative flex w-full flex-col items-start gap-sm",children:[r&&(0,a.jsx)("div",{className:"aspect-square w-full",children:(0,a.jsx)(o.W,{className:"pointer-events-none !rounded-md shadow-sm after:absolute after:inset-0 after:rounded-[inherit] after:border after:border-black/5 after:content-[''] group-hover:opacity-70",src:r})}),(0,a.jsxs)("div",{className:"flex w-full flex-1 flex-col gap-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)(h.Z,{variant:"smallBold",children:n.price}),(0,a.jsx)(h.Z,{variant:"small",color:"light",className:"line-clamp-2",children:n.name})]}),(0,a.jsx)("div",{className:"h-full flex-1"}),(0,a.jsxs)(h.Z,{variant:"tiny",color:"light",className:"flex items-center gap-xs",children:[(0,a.jsx)(E.D,{size:12,className:"inline-flex shrink-0",domain:n.merchant_info.merchant_domain}),(0,a.jsx)("span",{className:"line-clamp-1",children:n.merchant})]}),s&&(0,a.jsx)(c.D,{size:"2xs",reviewCount:i,rating:s,textVariant:"tiny",variant:"truncated"})]})]})})};var P=n(37462),T=n.n(P);let U=e=>{let{widgets:t,section:n,sectionTitle:s,onAddProduct:l,className:o,title:c}=e,{articleLocalState:m}=(0,i.useArticleResults)(),{removeWidget:p}=(0,u.Z)(),{trackEvent:x}=(0,y.WS)(),b=(0,r.useMemo)(()=>t.map(e=>{let t=d.id.safeParse(e.meta_data);if(!t.success)return f.Tb("Invalid widget data",{extra:{widget:e}}),null;let n=t.data;return"ShopifyWidget"===n.object?n:null}).filter(Boolean),[t]),j=(0,r.useCallback)(e=>{(null==n?void 0:n.backend_uuid)&&(p({sectionUUID:n.backend_uuid,urlToRemove:e}),x("remove widget",{entryUUID:n.backend_uuid,source:"page",url:e}))},[p,null==n?void 0:n.backend_uuid,x]),z=(0,r.useMemo)(()=>b.map((e,n)=>e&&"ShopifyWidget"===e.object?(0,a.jsx)(D,{item:e,canEdit:m.isEditModeEnabled,isFirst:0===n,isLast:n===t.length-1,onDelete:()=>j(e.url),idx:n},e.id):null).filter(Boolean),[b,m.isEditModeEnabled,j,t.length]);return 0===b.length?null:(0,a.jsx)("div",{children:(0,a.jsxs)(g.ZP,{variant:"offset",className:T()("flex flex-col rounded-lg px-md",o),children:[c&&(0,a.jsx)(h.Z,{className:"-mb-sm -ml-xs mt-sm",variant:"section-title",children:c}),(0,a.jsxs)(g.ZP,{className:"flex flex-col divide-y",children:[z,m.isEditModeEnabled&&n&&(0,a.jsx)(v,{section:n,sectionTitle:s,onAddProduct:l})]})]})})}},81854:function(e,t,n){n.d(t,{BO:function(){return y},id:function(){return _}});var a=n(63292);let r=a.z.object({name:a.z.string(),value:a.z.array(a.z.union([a.z.string(),a.z.number(),a.z.null(),a.z.undefined()]))}),i=a.z.object({name:a.z.string(),reportDate:a.z.array(a.z.string(),a.z.null()),item:a.z.array(r)}),s=a.z.object({requestId:a.z.string(),categories:a.z.array(i)}),l=a.z.array(s),o=a.z.object({type:a.z.literal("factset_fundamentals"),data:l}),c=a.z.array(a.z.object({currency:a.z.string(),date:a.z.string(),requestId:a.z.string(),price:a.z.number()})),d=a.z.object({type:a.z.literal("factset_global_prices"),data:c}),u=a.z.object({requestId:a.z.string(),asOfDate:a.z.string().optional(),currency:a.z.string()}).passthrough(),m=a.z.array(u),p=a.z.object({type:a.z.literal("factset_company_fundamentals"),data:m}),g=a.z.discriminatedUnion("type",[d,o,p]),h=a.z.object({is_attachment:a.z.boolean(),is_image:a.z.boolean(),is_code_interpreter:a.z.boolean(),is_knowledge_card:a.z.boolean(),is_map:a.z.boolean(),is_navigational:a.z.boolean(),is_widget:a.z.boolean()}),f=a.z.object({name:a.z.string(),snippet:a.z.string(),timestamp:a.z.string(),url:a.z.string(),meta_data:a.z.record(a.z.unknown()).nullable()}).and(h),x=a.z.object({object:a.z.literal("TakoWidget"),data:a.z.object({iframe:a.z.string(),url:a.z.string()})}),b=a.z.object({object:a.z.literal("TimeWidget"),data:a.z.object({time:a.z.string(),date:a.z.string(),location:a.z.string()})}),j=a.z.object({object:a.z.literal("CalculatorWidget"),data:a.z.object({expression:a.z.string(),result:a.z.number()})}),z=a.z.object({object:a.z.literal("WeatherWidget"),current:a.z.object({temp_c:a.z.number().optional(),temp_f:a.z.number().optional(),wind_mph:a.z.number().optional(),wind_kph:a.z.number().optional(),wind_dir:a.z.string().optional(),pressure_mb:a.z.number().optional(),pressure_in:a.z.number().optional(),precip_mm:a.z.number().optional(),precip_in:a.z.number().optional(),humidity:a.z.number().optional(),cloud:a.z.number().optional(),condition:a.z.object({text:a.z.string(),icon:a.z.string(),code:a.z.string()}).optional()}),location:a.z.object({name:a.z.string().optional(),country:a.z.string().optional(),tz_id:a.z.string().optional(),localtime:a.z.string().optional(),region:a.z.string().optional(),is_usa:a.z.union([a.z.literal(1),a.z.literal(0)]).optional()}),forecast:a.z.array(a.z.object({dow:a.z.string().optional(),icon:a.z.string().optional(),maxtemp_c:a.z.number().optional(),maxtemp_f:a.z.number().optional(),mintemp_c:a.z.number().optional(),mintemp_f:a.z.number().optional(),hour:a.z.array(a.z.object({temp_c:a.z.number(),temp_f:a.z.number(),time:a.z.string()}))}))}),v=a.z.array(a.z.object({src:a.z.string(),variants:a.z.array(a.z.string()),width:a.z.number().nullable(),height:a.z.number().nullable()})),y=a.z.object({object:a.z.literal("ShopifyWidget"),id:a.z.string(),url:a.z.string(),name:a.z.string(),description:a.z.string().nullable(),rating:a.z.number().nullable(),num_reviews:a.z.number().nullable(),currency_code:a.z.string().nullable(),images:v,options:a.z.array(a.z.object({name:a.z.string(),values:a.z.array(a.z.string())})).nullable(),variants:a.z.array(a.z.object({id:a.z.string(),title:a.z.string(),price:a.z.string().nullable(),compare_at_price:a.z.string().nullable(),option1:a.z.string().nullable(),option2:a.z.string().nullable(),option3:a.z.string().nullable()})).nullable(),merchant_info:a.z.object({merchant_name:a.z.string(),merchant_domain:a.z.string(),total_reviews:a.z.number().nullable(),average_rating:a.z.number().nullable(),logo_url:a.z.string().nullable()}),merchant:a.z.string().nullable(),image_url:a.z.string().nullable(),price:a.z.string().nullable(),client:a.z.string(),is_card:a.z.boolean(),review_summary:a.z.object({summary:a.z.string(),review_quality_score:a.z.number(),pros_detailed:a.z.array(a.z.object({label:a.z.string(),description:a.z.string()})).optional(),cons_detailed:a.z.array(a.z.object({label:a.z.string(),description:a.z.string()})).optional(),pros:a.z.array(a.z.string()),cons:a.z.array(a.z.string()),key_features:a.z.array(a.z.string()),review_search_results:a.z.array(f),buy_if:a.z.string().optional()}).nullable()}),w=a.z.object({object:a.z.literal("FinanceWidget"),data:a.z.array(g)}),_=a.z.discriminatedUnion("object",[z,x,b,j,y,w])},73612:function(e,t,n){n.d(t,{SL:function(){return L},qy:function(){return G},OT:function(){return B}});var a=n(53854),r=n(20981),i=n(42946),s=n(70537),l=n(92225);let o=e=>{let{graphData:t}=e,[n,{height:r}]=(0,i.Z)();return(0,a.jsx)(s.s,{children:(0,a.jsx)(l.E.div,{animate:r>0?{height:r}:{},transition:{type:"spring",bounce:.2,duration:.2},children:(0,a.jsx)("div",{ref:n,children:(0,a.jsx)("img",{src:t.url,alt:"Graph",className:"mx-auto block h-auto max-w-[70%]"})})})})};var c=n(95500),d=n(81854),u=n(85271),m=n(6503);let p=(0,c.default)(()=>Promise.all([n.e(3101),n.e(3449),n.e(203)]).then(n.bind(n,70203)).then(e=>e.WeatherWidget),{loadableGenerated:{webpack:()=>[70203]},loading:()=>(0,a.jsx)(u.default,{size:"large"})}),g=(0,c.default)(()=>n.e(4256).then(n.bind(n,74256)).then(e=>e.TimeWidget),{loadableGenerated:{webpack:()=>[74256]},loading:()=>(0,a.jsx)(u.default,{size:"small"})}),h=(0,c.default)(()=>n.e(1328).then(n.bind(n,41328)).then(e=>e.CalculatorWidget),{loadableGenerated:{webpack:()=>[41328]},loading:()=>(0,a.jsx)(u.default,{size:"small"})}),f=(0,c.default)(()=>n.e(7479).then(n.bind(n,50560)).then(e=>e.TakoWidget),{loadableGenerated:{webpack:()=>[50560]},loading:()=>(0,a.jsx)(u.default,{size:"large"})}),x=(0,c.default)(()=>Promise.resolve().then(n.bind(n,28621)).then(e=>e.ShopifyWidget),{loadableGenerated:{webpack:()=>[28621]},loading:()=>(0,a.jsx)(u.default,{size:"large"})}),b=(0,c.default)(()=>Promise.all([n.e(3101),n.e(219),n.e(4596),n.e(9348)]).then(n.bind(n,22115)).then(e=>e.default),{loadableGenerated:{webpack:()=>[22115]},loading:()=>(0,a.jsx)(u.default,{size:"large"})}),j=e=>{let{widgetData:t,menuItems:n,contextUUID:r,idx:i}=e,l=d.id.safeParse(t.meta_data);if(!l.success)return m.Tb("Invalid widget data",{extra:{widgetData:t}}),null;let o=l.data,c=o.object;switch(c){case"WeatherWidget":return(0,a.jsx)(s.s,{menuItems:n,variant:"noChrome",children:(0,a.jsx)(p,{...o})});case"TimeWidget":return(0,a.jsx)(s.s,{menuItems:n,children:(0,a.jsx)(g,{...o})});case"CalculatorWidget":return(0,a.jsx)(s.s,{menuItems:n,children:(0,a.jsx)(h,{...o})});case"TakoWidget":return(0,a.jsx)(s.s,{menuItems:n,children:(0,a.jsx)(f,{...o})});case"ShopifyWidget":return(0,a.jsx)(s.s,{menuItems:n,variant:"noChrome",children:(0,a.jsx)(x,{item:o,contextUUID:r,idx:i})});case"FinanceWidget":return(0,a.jsx)(s.s,{menuItems:n,variant:"noChrome",children:(0,a.jsx)(b,{...o})});default:return m.Tb(Error("No PanelComponent found for livePanelType: ".concat(c))),null}};var z=n(60359),v=n(97825),y=n(77301),w=n(86096),_=n(64980),k=n(14283),N=n(53118),C=n(40057);let S=e=>e.replace(/[.*+\-?^${}()|[\]\\]/g,"\\$&");var E=n(86128),D=n(92508),Z=n(37462),I=n.n(Z);let W=e=>{let{icon:t,name:n,value:i,entities:l,onEntityClick:o}=e,{inFlight:c}=(0,w.a0)(),d=(null==l?void 0:l.length)>0,u=(0,r.useMemo)(()=>d?RegExp("(".concat(l.map(S).join("|"),")"),"g"):null,[d,l]),m=(0,r.useMemo)(()=>i.split(u),[i,u]),p=(0,r.useCallback)(e=>{c||o(e)},[c,o]),g=I()("underline-thickness-thin underline-offset-sm cursor-pointer decoration-textOff/60 decoration-dotted hover:text-super hover:decoration-super dark:decoration-textOffDark/60 dark:hover:text-superDark dark:hover:decoration-superDark group transition-colors duration-200 ease-in-out",{underline:!c}),h=(0,r.useCallback)(e=>{let{content:t}=e,n=t.startsWith("http://")||t.startsWith("https://")?t:"https://".concat(t);return(0,a.jsxs)(N.default,{href:n,target:"_blank",rel:"noopener noreferrer",className:g,children:[t,(0,a.jsx)(D.Z,{className:"ml-xs inline",variant:"tiny",children:(0,a.jsx)(_.G,{className:"transition-colors duration-200 ease-in-out group-hover:text-super dark:group-hover:text-superDark",icon:E.t3})})]})},[g]),f=(0,r.useMemo)(()=>m.map(e=>d&&l.includes(e)?(0,a.jsx)("span",{className:g,onClick:()=>p(e),children:e},"".concat(e,"-").concat(Math.random())):(0,a.jsx)(C.Z,{fallback:(0,a.jsx)("div",{children:e}),children:(0,a.jsx)(k.Z,{options:{render:h},children:e})},"".concat(e,"-").concat(Math.random()))),[m,d,l,g,h,p]);return(0,a.jsx)(s.s.Item,{icon:t,name:n,value:f},n)};var P=n(22778),T=n(49572),U=n(78113),M=n(2355);let R=r.memo(e=>{let{data:t,isReadonly:n,submit:o}=e,{title:c,subtitle:d,attributes:u,image_url:m,source_url:p}=t,{trackEvent:g}=(0,y.WS)(),{threadMetadata:h}=(0,w.a0)(),f=h.frontendContextUUID,x=(0,v.useRouter)(),[b,j]=(0,r.useState)(3),_=u.length,k=b===_,N=u.length>3,C=(0,z.useTranslations)("panel"),{menuItems:S}=(0,s.u)(),E=(0,r.useCallback)(()=>{g("click toggle on knowledge card",{newState:k?"collapsed":"expanded"}),j(e=>3===e?_:3)},[g,k,_]),[D,{height:Z}]=(0,i.Z)(),I=(0,U.Mp)(),R=(0,r.useCallback)(e=>{if(o({fork:n,rawQuery:e,collection:null,newFrontendContextUUID:n?I:null,existingFrontendContextUUID:n?null:f,promptSource:"user",querySource:"entity_link"}),n){let t=new URLSearchParams({q:e,newFrontendContextUUID:I}),n=new URL(window.location.href);n.pathname="search/new",n.search=t.toString();let a=n.toString();x.push(a)}},[o,n,I,f,x]);return(0,r.useEffect)(()=>{g("entry panel shown",{})},[g]),(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)(l.E.div,{animate:Z>0?{height:Z}:{},transition:{type:"spring",bounce:.2,duration:.2},className:"overflow-hidden",children:(0,a.jsxs)("div",{ref:D,className:"relative",children:[(0,a.jsx)("div",{className:"flex items-end justify-between",children:(0,a.jsx)(s.s.Title,{title:c,subtitle:d,image_url:m,href:p,children:(0,a.jsx)("div",{className:"flex items-start",children:(0,a.jsxs)("div",{className:"flex items-center gap-sm",children:[S&&(null==S?void 0:S.length)>0&&(0,a.jsx)(s.s.Menu,{menuItems:S}),N&&(0,a.jsx)("div",{className:"flex justify-end",children:(0,a.jsx)(M.Z,{variant:"common",text:C(k?"less":"more"),size:"tiny",pill:!0,onClick:E,icon:k?T.mT:P.pt})})]})})})}),(0,a.jsx)("div",{className:"grid grid-cols-[auto,1fr] gap-x-sm gap-y-sm md:gap-x-md",children:u.slice(0,b).map(e=>(0,a.jsx)(W,{icon:e.icon,name:e.name,value:e.value,entities:e.key_entities,onEntityClick:R},e.name))})]})})})}),O=e=>{let{knowledgePanelData:t,summaryData:n,isReadonly:r,submit:i,menuItems:l}=e;if(!t&&!n)return null;let o=t?function(e){let{meta_data:{title:t,subtitle:n,attributes:a,image_url:r},url:i}=e;return{title:t,subtitle:n,attributes:a,image_url:r,source_url:i}}(t):function(e){let{title:t,subtitle:n,bullet_points:a}=e;return{title:t,subtitle:n,attributes:a.map(e=>{let{Descriptor:t,bullet_point:n}=e;return{icon:"",name:t,value:n,key_entities:[]}}),image_url:"",source_url:""}}(n);return(0,a.jsx)(s.s,{menuItems:l,children:(0,a.jsx)(R,{data:o,submit:i,isReadonly:r})})};var q=n(22571);function F(e){return e&&"is_widget"in e&&!0===e.is_widget}function B(e){return e&&F(e)&&"ShopifyWidget"===e.meta_data.object}function G(e){return e.some(e=>B(e))}let L=e=>{let{data:t,submit:n,isReadonly:r=!1,menuItems:i,contextUUID:s,idx:l}=e;return(0,a.jsxs)(q.ZP,{children:[F(t)&&(0,a.jsx)(j,{widgetData:t,menuItems:null!=i?i:[],contextUUID:s,idx:l}),t&&"is_knowledge_card"in t&&t.is_knowledge_card&&(0,a.jsx)(O,{knowledgePanelData:t,summaryData:null,submit:n,isReadonly:r,menuItems:null!=i?i:[],idx:l}),"is_code_interpreter"in t&&!0===t.is_code_interpreter&&t.is_image&&(0,a.jsx)(o,{graphData:t})]})}},12496:function(e,t,n){n.d(t,{m:function(){return f}});var a=n(53854),r=n(20981),i=n(60359),s=n(98510),l=n(41038),o=n(53141),c=n(4009),d=n(22571),u=n(2355),m=n(95359),p=n(92225),g=n(1837),h=n(69650);let f=r.memo(e=>{let{showStopButton:t,onStopButtonClick:n,...f}=e,{currentOpenedModal:x}=(0,s.useModalState)(),{isMobileUserAgent:b}=(0,c.d)(),j=(0,i.useTranslations)("main.askInput"),z=(0,r.useCallback)(e=>{"Escape"===e.key&&t&&n&&null===x&&(e.preventDefault(),n())},[n,t,x]);return(0,r.useEffect)(()=>(document.addEventListener("keydown",z),()=>{document.removeEventListener("keydown",z)}),[z]),(0,a.jsx)(d.ZP,{className:"w-full",children:(0,a.jsx)(m.A,{transition:{duration:.2,bounce:.2,type:"spring"},children:(0,a.jsx)(p.E.div,{layout:!0,layoutRoot:!0,className:"flex items-center gap-x-xs",children:(0,a.jsx)(g.S,{children:(0,a.jsxs)(h.M,{mode:"popLayout",initial:!1,children:[t&&(0,a.jsx)(p.E.div,{initial:{scale:.2,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.2,opacity:0},children:(0,a.jsx)(u.Z,{toolTip:j("stopGenerating"),variant:"rejecter",pill:!0,icon:o.oD,keyboardShortcut:["Esc"],onClick:n})},"stop-button"),(0,a.jsx)(p.E.div,{layout:!0,className:"grow",children:(0,a.jsx)(l.Z,{borderClass:"md:p-sm bg-offset dark:bg-offsetDark",hasShadow:!0,showFileUpload:!0,showCopilotToggle:!0,autofocus:null===x&&!b,querySource:f.submitWillFork?"fork":"followup",...f})},"ask-input")]})})})})})})},40057:function(e,t,n){var a=n(53854),r=n(20981);class i extends r.Component{static getDerivedStateFromError(){return{hasError:!0}}componentDidCatch(e,t){console.error({error:e,errorInfo:t})}render(){if(this.state.hasError){var e;return(null===(e=this.props)||void 0===e?void 0:e.fallback)?this.props.fallback:(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{children:"Oops, there is an error!"}),(0,a.jsx)("button",{type:"button",onClick:()=>this.setState({hasError:!1}),children:"Try again?"})]})}return this.props.children}constructor(e){super(e),this.state={hasError:!1}}}t.Z=i},24307:function(e,t,n){n.d(t,{z:function(){return l}});var a=n(20981),r=n(15117),i=n(37771),s=n(77301);function l(){let[e,t]=(0,a.useState)(i.ZW),{trackEvent:n}=(0,s.WS)();return(0,a.useEffect)(()=>{let n=(0,r.yG)();n&&i.RF.includes(n)&&e!==n&&t(n)},[]),{saveLocale:e=>{if(!i.RF.includes(e)){console.log("Unsupported locale: ",e);return}(0,r.A6)(e),t(e),n("set locale cookie",{locale:e})},locale:e}}},70561:function(e,t,n){n.d(t,{$:function(){return l}});var a=n(20981),r=n(97455),i=n(87442),s=n.n(i);let l=e=>{let{items:t,inFlight:n,inFlightLatest:i,rwToken:l,headerOffset:o=52}=e,[c,d]=(0,a.useState)(!1),[u,m]=(0,a.useState)(!1),p=(0,r.f)(),g=(0,a.useRef)(!0),h=(0,a.useMemo)(()=>!l&&t.every(e=>"pending"!==e.status),[t,l]),f=(0,a.useMemo)(()=>t.some(e=>"pending"===e.status),[t]),[x,b]=(0,a.useState)({}),[j,z]=(0,a.useState)({}),v=(0,a.useCallback)(function(e){var t,n;let a=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r="number"==typeof e?null===(t=x[e])||void 0===t?void 0:t.current:null===(n=j[e])||void 0===n?void 0:n.current;if(r){let e=r.getBoundingClientRect().top+window.scrollY-o;window.scrollTo({top:e,behavior:a?"smooth":"auto"})}},[x,j,o]),y=(0,a.useCallback)(()=>{v(t.length-1)},[v,t.length]);return(0,a.useEffect)(()=>{b(e=>{let n={...e},r={...j},i=!1;return t.forEach((e,t)=>{let s=e.backend_uuid;if(n[t]&&n[t].current)r[s]=n[t];else{let e=a.createRef();n[t]=e,r[s]=e,i=!0}}),Object.keys(n).forEach(e=>{t.some((t,n)=>n===Number(e))||(delete n[Number(e)],i=!0)}),i&&z(r),i?n:e})},[t.length,j,f]),(0,a.useEffect)(()=>{if(t.length<=1||!p)return;let e=window.location.hash;if(e&&!n&&g.current){try{let t=e.slice(1);t.length>3?v(t,!1):v(Number(t),!1)}catch(e){console.error(e)}return}i&&v(t.length-1)},[n,i,h,t.length,x,j,p,v]),(0,a.useEffect)(()=>{let e=s()(()=>{var e;let n=null===(e=x[t.length-1])||void 0===e?void 0:e.current;if(n){let e=n.getBoundingClientRect().top+window.scrollY-100,t=document.body.scrollHeight>window.innerHeight,a=window.innerHeight+window.scrollY>=document.body.scrollHeight-10;if(window.scrollY>=e||!t||a)c&&m(!0),d(!1);else{if(u)return;d(!0)}}},200);return e(),window.addEventListener("scroll",e),()=>{window.removeEventListener("scroll",e),e.cancel()}},[x,c,u,t.length]),{refs:x,scrollToLatestItem:y,scrollToListItem:v,showScrollButton:c&&!u,hasScrolled:u,setHasScrolled:m}}},43065:function(e,t,n){n.d(t,{i:function(){return a}});let a=n(45038).iF}}]);